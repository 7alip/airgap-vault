{"version":3,"sources":["./src/app/pages/account-add/account-add.module.ts","./src/app/pages/account-add/account-add.page.ts","./src/app/pages/account-add/account-add.page.html"],"names":[],"mappings":"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","file":"pages-account-add-account-add-module.js","sourcesContent":["import { AirGapAngularCoreModule } from '@airgap/angular-core'\nimport { CommonModule } from '@angular/common'\nimport { NgModule } from '@angular/core'\nimport { FormsModule } from '@angular/forms'\nimport { RouterModule, Routes } from '@angular/router'\nimport { IonicModule } from '@ionic/angular'\nimport { TranslateModule } from '@ngx-translate/core'\n\nimport { ComponentsModule } from '../../components/components.module'\n\nimport { AccountAddPage } from './account-add.page'\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: AccountAddPage\n  }\n]\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    ComponentsModule,\n    IonicModule,\n    RouterModule.forChild(routes),\n    TranslateModule,\n    AirGapAngularCoreModule\n  ],\n  declarations: [AccountAddPage]\n})\nexport class AccountAddPageModule {}\n","import { Component } from '@angular/core'\nimport { ModalController, AlertController } from '@ionic/angular'\nimport { ICoinProtocol } from '@airgap/coinlib-core'\n\nimport { ErrorCategory, handleErrorLocal } from '../../services/error-handler/error-handler.service'\nimport { NavigationService } from '../../services/navigation/navigation.service'\nimport { SecretsService } from '../../services/secrets/secrets.service'\nimport { VaultStorageKey, VaultStorageService } from '../../services/storage/storage.service'\nimport { LocalAuthenticationOnboardingPage } from '../local-authentication-onboarding/local-authentication-onboarding.page'\nimport { BIP39_PASSPHRASE_ENABLED } from 'src/app/constants/constants'\nimport { ProtocolService } from '@airgap/angular-core'\n\n@Component({\n  selector: 'airgap-account-add',\n  templateUrl: './account-add.page.html',\n  styleUrls: ['./account-add.page.scss']\n})\nexport class AccountAddPage {\n  public selectedProtocol: ICoinProtocol\n  public protocols: ICoinProtocol[]\n  public isHDWallet: boolean = false\n\n  public isAdvancedMode: boolean = false\n  public isBip39PassphraseEnabled: boolean = BIP39_PASSPHRASE_ENABLED\n  public revealBip39Passphrase: boolean = false\n  public customDerivationPath: string\n  public bip39Passphrase: string = ''\n\n  constructor(\n    private readonly secretsService: SecretsService,\n    private readonly storageService: VaultStorageService,\n    private readonly protocolService: ProtocolService,\n    private readonly modalController: ModalController,\n    private readonly navigationService: NavigationService,\n    private readonly alertController: AlertController\n  ) {\n    this.protocolService.getActiveProtocols().then((protocols: ICoinProtocol[]) => {\n      this.protocols = protocols\n      this.onSelectedProtocolChange(this.navigationService.getState().protocol || this.protocols[0])\n    })\n  }\n\n  public onSelectedProtocolChange(selectedProtocol: ICoinProtocol): void {\n    this.selectedProtocol = selectedProtocol\n    this.isHDWallet = this.selectedProtocol.supportsHD\n    this.customDerivationPath = this.selectedProtocol.standardDerivationPath\n  }\n\n  public async addWallet(): Promise<void> {\n    const value: boolean = await this.storageService.get(VaultStorageKey.DISCLAIMER_HIDE_LOCAL_AUTH_ONBOARDING)\n    if (!value) {\n      const modal: HTMLIonModalElement = await this.modalController.create({\n        component: LocalAuthenticationOnboardingPage\n      })\n\n      modal\n        .onDidDismiss()\n        .then(() => {\n          this.addWalletAndReturnToAddressPage()\n        })\n        .catch(handleErrorLocal(ErrorCategory.IONIC_MODAL))\n\n      modal.present().catch(handleErrorLocal(ErrorCategory.IONIC_MODAL))\n    } else {\n      this.addWalletAndReturnToAddressPage()\n    }\n  }\n\n  private async addWalletAndReturnToAddressPage(): Promise<void> {\n    const addAccount = () => {\n      this.secretsService\n        .addWallets(\n          this.protocols.map((protocol: ICoinProtocol) => {\n            const isSelected: boolean = this.selectedProtocol.identifier === protocol.identifier\n\n            return {\n              protocolIdentifier: protocol.identifier,\n              isHDWallet: protocol.supportsHD,\n              customDerivationPath: isSelected ? this.customDerivationPath : protocol.standardDerivationPath,\n              bip39Passphrase: isSelected ? this.bip39Passphrase : '',\n              isActive: isSelected\n            }\n          })\n        )\n        .then(() => {\n          this.navigationService.routeToAccountsTab().catch(handleErrorLocal(ErrorCategory.IONIC_NAVIGATION))\n        })\n        .catch(handleErrorLocal(ErrorCategory.SECURE_STORAGE))\n    }\n\n    if (this.bip39Passphrase.length > 0) {\n      const alert = await this.alertController.create({\n        header: 'BIP-39 Passphrase',\n        message:\n          'You set a BIP-39 Passphrase. You will need to enter this passphrase again when you import your secret. If you lose your passphrase, you will lose access to your account!',\n        backdropDismiss: false,\n        inputs: [\n          {\n            name: 'understood',\n            type: 'checkbox',\n            label: 'I understand',\n            value: 'understood',\n            checked: false\n          }\n        ],\n        buttons: [\n          {\n            text: 'Cancel',\n            role: 'cancel'\n          },\n          {\n            text: 'Ok',\n            handler: async (result: string[]) => {\n              if (result.includes('understood')) {\n                addAccount()\n              }\n            }\n          }\n        ]\n      })\n      alert.present()\n    } else {\n      addAccount()\n    }\n  }\n}\n","<ion-header class=\"ion-no-border\">\n  <ion-toolbar>\n    <ion-buttons slot=\"start\">\n      <ion-back-button defaultHref=\"/tabs/tab-accounts\"></ion-back-button>\n    </ion-buttons>\n    <ion-title>{{ 'wallet-select-coins.title' | translate }}</ion-title>\n  </ion-toolbar>\n</ion-header>\n\n<ion-content class=\"ion-padding\">\n  <airgap-current-secret></airgap-current-secret>\n\n  <ion-list lines=\"none\">\n    <ion-radio-group [ngModel]=\"selectedProtocol\" (ngModelChange)=\"onSelectedProtocolChange($event)\">\n      <ion-list-header class=\"ion-no-padding\">\n        <ion-label class=\"font--weight__med white\">{{ 'wallet-select-coins.text' | translate }}</ion-label>\n      </ion-list-header>\n      <ion-item detail=\"false\" class=\"ion-no-padding\" *ngFor=\"let protocol of protocols\">\n        <ion-avatar slot=\"start\" class=\"ion-align-items-center\">\n          <airgap-currency-symbol [symbol]=\"protocol.symbol\"></airgap-currency-symbol>\n        </ion-avatar>\n        <ion-label class=\"ion-text-wrap\">\n          <h2>\n            <span class=\"font--weight__med\">{{ protocol.name }}</span>\n            {{ protocol.symbol }}\n          </h2>\n        </ion-label>\n        <ion-radio [id]=\"protocol.identifier\" [value]=\"protocol\" slot=\"end\"></ion-radio>\n      </ion-item>\n    </ion-radio-group>\n  </ion-list>\n\n  <ion-list lines=\"none\" class=\"ion-padding-vertical ion-margin-bottom\">\n    <ion-item class=\"ion-no-padding\">\n      <ion-label class=\"font--weight__med\">{{ 'wallet-select-coins.advanced_label' | translate }}</ion-label>\n      <ion-toggle color=\"primary\" slot=\"end\" [(ngModel)]=\"isAdvancedMode\"></ion-toggle>\n    </ion-item>\n\n    <ng-container *ngIf=\"isAdvancedMode\">\n      <ion-item class=\"ion-no-padding\" *ngIf=\"isAdvancedMode\" lines=\"full\">\n        <ion-label position=\"stacked\" color=\"primary\">{{ 'wallet-select-coins.custom-path.label' | translate }}</ion-label>\n        <ion-input\n          [(ngModel)]=\"customDerivationPath\"\n          placeholder=\"{{ 'wallet-select-coins.custom-path.placeholder' | translate }}\"\n        ></ion-input>\n      </ion-item>\n\n      <ng-container *ngIf=\"isBip39PassphraseEnabled\">\n        <ion-item class=\"ion-no-padding\" *ngIf=\"isBip39PassphraseEnabled\" lines=\"full\">\n          <ion-label position=\"stacked\" color=\"primary\">BIP-39 Passphrase</ion-label>\n          <ion-input\n            [type]=\"revealBip39Passphrase ? 'text' : 'password'\"\n            [(ngModel)]=\"bip39Passphrase\"\n            placeholder=\"BIP-39 Passphrase\"\n          ></ion-input>\n        </ion-item>\n        <ion-item class=\"ion-no-padding ion-margin-bottom\">\n          Reveal Passphrase\n          <ion-checkbox [(ngModel)]=\"revealBip39Passphrase\" slot=\"end\"></ion-checkbox>\n        </ion-item>\n      </ng-container>\n    </ng-container>\n  </ion-list>\n\n  <ion-fab vertical=\"bottom\" horizontal=\"end\" slot=\"fixed\">\n    <ion-button [disabled]=\"!selectedProtocol\" color=\"primary\" shape=\"round\" (click)=\"addWallet()\">\n      {{ 'wallet-select-coins.create_label' | translate }}\n    </ion-button>\n  </ion-fab>\n</ion-content>\n"],"sourceRoot":"webpack:///"}